System.register(["./index-d48cc0ba.js","./sprite-renderer-a2b4676c.js","./director-39a00fed.js","./node-event-2a6499e4.js","./pipeline-state-manager-1c54311a.js","./buffer-barrier-a01f2732.js"],(function(t){"use strict";var e,i,n,r,s,a,o,h,u,l,f,c,p,_,d,y,g,m,D,F,v,A,x,S,T,b,R,w,E,C,O,k,U,L,M,I,z,P,H,B;return{setters:[function(t){e=t.bE,i=t.bF,n=t.c4,r=t.bR,s=t.bI,a=t.l,o=t.bj,h=t.bC,u=t.bH,l=t.bh,f=t.cJ,c=t.bX,p=t.w,_=t.c1,d=t.bN,y=t.B,g=t.d,m=t.bG,D=t.aQ,F=t.S,v=t.y,A=t.V,x=t.ae,S=t.cy,T=t.bV,b=t.J},function(t){R=t.a,w=t.I,E=t.b},function(t){C=t.bH,O=t.aU,k=t.b1,U=t.aT,L=t.b0,M=t.bJ,I=t.b5,z=t.b4},function(t){P=t.A,H=t.e},function(){},function(t){B=t.a3}],execute:function(){var N,V,W;t({e:function(t){var e=t.charCodeAt(0);return e>=9&&e<=13||32===e||133===e||160===e||5760===e||e>=8192&&e<=8202||8232===e||8233===e||8239===e||8287===e||12288===e},f:function(t){return Dt.test(t)},g:function(){return 0},h:function(t){return mt.test(t)},i:function(t){return/^[\u4E00-\u9FFF\u3400-\u4DFF]+$/.test(t)||/[\u3000-\u303F]|[\u3040-\u309F]|[\u30A0-\u30FF]|[\uFF00-\uFFEF]|[\u4E00-\u9FAF]|[\u2605-\u2606]|[\u2190-\u2195]|\u203B/g.test(t)||/^[\u1100-\u11FF]|[\u3130-\u318F]|[\uA960-\uA97F]|[\uAC00-\uD7AF]|[\uD7B0-\uD7FF]+$/.test(t)},j:function(t){return Dt.exec(t)},k:function(t){return mt.exec(t)},l:function(t,e,i,n){var r=[];if(0===t.length||i<0)return r.push(""),r;for(var s=t;e>i&&s.length>1;){for(var a=s.length*(i/e)|0,o=vt(s,a),h=e-n(o),u=o,l=0,f=0;h>i&&f++<100;)a*=i/h,h=e-n(o=vt(s,a|=0));for(f=0;o&&h<=i&&f++<100;){var c=dt.exec(o);u=o,h=e-n(o=vt(s,a+=l=c?c[0].length:1))}0==(a-=l)?(a=1,u=vt(s,1)):1===a&&s[0]>="\ud800"&&s[0]<="\udbff"&&(a=2,u=vt(s,2));var p=vt(s,0,a),_=void 0;yt.test(u||o)&&(0==(a-=(_=gt.exec(p))?_[0].length:0)&&(a=1),u=vt(s,a),p=vt(s,0,a)),Dt.test(u)&&(_=mt.exec(p))&&p!==_[0]&&(u=vt(s,a-=_[0].length),p=vt(s,0,a)),(0===r.length||(p=p.trim()).length>0)&&r.push(p),e=n(s=u||o)}return(0===r.length||(s=s.trim()).length>0)&&r.push(s),r},q:function(t){var e=t.color.toHEX(),i="";return t.isOutlined&&t.margin>0&&(i=i+t.margin+t.out.toHEX()),""+t.fontSize+t.fontFamily+e+i},s:Ft});var X,Y=t("S",e("cc.SpriteAtlas")((V=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).spriteFrames=W&&W(),e}i(e,t);var s=e.prototype;return s.getTexture=function(){var t=Object.keys(this.spriteFrames);if(t.length>0){var e=this.spriteFrames[t[0]];return e&&e.texture}return null},s.getSpriteFrame=function(t){var e=this.spriteFrames[t];return e?(e.name||(e.name=t),e):null},s.getSpriteFrames=function(){for(var t=[],e=this.spriteFrames,i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];t.push(e[r])}return t},s._serialize=function(){},s._deserialize=function(t,e){var i=t;this._name=i.name;var s=i.spriteFrames;this.spriteFrames=n();for(var a=0;a<s.length;a+=2)e.result.push(this.spriteFrames,s[a],s[a+1],r(R))},e}(P),W=s(V.prototype,"spriteFrames",[o],(function(){return n()})),N=V))||N);a.SpriteAtlas=Y;var j,G,Z,K=t("F",e("cc.Font")(X=function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e}(P))||X);a.Font=K;var $,J,q,Q,tt,et,it,nt,rt=t("T",e("cc.TTFFont")((G=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._fontFamily=Z&&Z(),e}return i(e,t),e.prototype.initDefault=function(e){this._fontFamily="Arial",t.prototype.initDefault.call(this,e)},h(e,[{key:"_nativeAsset",get:function(){return this._fontFamily},set:function(t){this._fontFamily=t||"Arial"}},{key:"_nativeDep",get:function(){return{uuid:this._uuid,__nativeName__:this._native,ext:H(this._native),__isNative__:!0}}}]),e}(K),Z=s(G.prototype,"_fontFamily",[o],(function(){return null})),u(G.prototype,"_nativeAsset",[l,f],Object.getOwnPropertyDescriptor(G.prototype,"_nativeAsset"),G.prototype),u(G.prototype,"_nativeDep",[l],Object.getOwnPropertyDescriptor(G.prototype,"_nativeDep"),G.prototype),j=G))||j);a.TTFFont=rt;var st,at=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.offsetX=0,this.offsetY=0,this.textureID=0,this.valid=!1,this.xAdvance=0},ot=t("p",function(){function t(t){this.letterDefinitions={},this.texture=t}var e=t.prototype;return e.addLetterDefinitions=function(t,e){this.letterDefinitions[t]=e},e.cloneLetterDefinition=function(){for(var t={},e=0,i=Object.keys(this.letterDefinitions);e<i.length;e++){var n=i[e],r=new at;_(r,this.letterDefinitions[n]),t[n]=r}return t},e.getTexture=function(){return this.texture},e.getLetter=function(t){return this.letterDefinitions[t]},e.getLetterDefinitionForChar=function(t){var e=t.charCodeAt(0);return this.letterDefinitions.hasOwnProperty(e)?this.letterDefinitions[e]:null},e.clear=function(){this.letterDefinitions={}},t}()),ht=t("B",($=e("cc.BitmapFont"),J=c(R),$((Q=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this).fntDataStr=tt&&tt(),e.spriteFrame=et&&et(),e.fontSize=it&&it(),e.fntConfig=nt&&nt(),e}return i(e,t),e.prototype.onLoaded=function(){var t=this.spriteFrame;!this.fontDefDictionary&&t&&(this.fontDefDictionary=new ot(t.texture));var e=this.fntConfig;if(e){var i=e.fontDefDictionary;for(var n in i){var r=new at,s=i[n].rect;r.offsetX=i[n].xOffset,r.offsetY=i[n].yOffset,r.w=s.width,r.h=s.height,r.u=s.x,r.v=s.y,r.textureID=0,r.valid=!0,r.xAdvance=i[n].xAdvance,this.fontDefDictionary.addLetterDefinitions(n,r)}}else p("The fnt config is not exists!")},e}(K),tt=s(Q.prototype,"fntDataStr",[o],(function(){return""})),et=s(Q.prototype,"spriteFrame",[J],(function(){return null})),it=s(Q.prototype,"fontSize",[o],(function(){return-1})),nt=s(Q.prototype,"fntConfig",[o],(function(){return null})),q=Q))||q));a.BitmapFont=ht;var ut=t("L",e("cc.LabelAtlas")(st=function(t){function e(){return t.apply(this,arguments)||this}return i(e,t),e}(ht))||st);a.LabelAtlas=ut;var lt=t("c",.26),ft=t("M",(lt+1)/2-lt);var ct=new d(2);ct.get=function(){return this._get()||{key:"",value:0,prev:null,next:null}};var pt,_t=new(t("d",function(){function t(t){this.count=0,this.limit=0,this.datas={},this.limit=t}var e=t.prototype;return e.moveToHead=function(t){t.next=this.head,t.prev=null,this.head&&(this.head.prev=t),this.head=t,this.tail||(this.tail=t),this.count++,this.datas[t.key]=t},e.put=function(t,e){var i=ct.get();if(i.key=t,i.value=e,this.count>=this.limit){var n=this.tail;delete this.datas[n.key],this.count--,this.tail=n.prev,this.tail.next=null,n.prev=null,n.next=null,ct.put(n)}this.moveToHead(i)},e.remove=function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev,delete this.datas[t.key],this.count--},e.get=function(t){var e=this.datas[t];return e?(this.remove(e),this.moveToHead(e),e.value):null},e.clear=function(){this.count=0,this.datas={},this.head=null,this.tail=null},e.has=function(t){return!!this.datas[t]},e.delete=function(t){var e=this.datas[t];this.remove(e)},t}()))(100),dt=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûа-яА-ЯЁё]+|\S)/,yt=/^[!,.:;'}\]%\?>、‘“》？。，！]/,gt=/([a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+|\S)$/,mt=/[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]+$/,Dt=/^[a-zA-Z0-9ÄÖÜäöüßéèçàùêâîôûаíìÍÌïÁÀáàÉÈÒÓòóŐőÙÚŰúűñÑæÆœŒÃÂãÔõěščřžýáíéóúůťďňĚŠČŘŽÁÍÉÓÚŤżźśóńłęćąŻŹŚÓŃŁĘĆĄ-яА-ЯЁёáàảạãăắằẳẵặâấầẩẫậéèẻẽẹêếềểễệiíìỉĩịóòỏõọôốồổỗộơớờởỡợúùủũụưứừửữựýỳỷỹỵđÁÀẢẠÃĂẮẰẲẴẶÂẤẦẨẪẬÉÈẺẼẸÊẾỀỂỄỆIÍÌỈĨỊÓÒỎÕỌÔỐỒỔỖỘƠỚỜỞỠỢÚÙỦŨỤƯỨỪỬỮỰÝỲỶỸỴĐ]/;function Ft(t,e,i){var n=(i||t.font)+"🎮"+e,r=_t.get(n);if(null!==r)return r;var s=t.measureText(e),a=s&&s.width||0;return _t.put(n,a),a}function vt(t,e,i){var n=e,r=i,s=t[e];if(s>="\udc00"&&s<="\udfff"&&n--,void 0!==i)if(i-1!==e){var a=t[i-1];a>="\ud800"&&a<="\udbff"&&r--}else s>="\ud800"&&s<="\udbff"&&r++;return t.substring(n,r)}var At=t("m",function(){function t(){this.pool=[]}t.getInstance=function(){return pt||(pt=new t),pt};var e=t.prototype;return e.get=function(){var t=this.pool.pop();if(!t){var e=m.document.createElement("canvas"),i=e.getContext("2d");t={canvas:e,context:i}}return t},e.put=function(t){this.pool.length>=D.MAX_LABEL_CANVAS_POOL_SIZE||this.pool.push(t)},t}()),xt=y.WHITE.clone(),St=function(){this.u=0,this.v=0,this.w=0,this.h=0,this.texture=null,this.offsetX=0,this.offsetY=0,this.valid=!1,this.xAdvance=0},Tt="rgba(255, 255, 255, "+(1/255).toFixed(3)+")",bt=function(){function t(t,e){this.image=null,this.labelInfo=void 0,this.char=void 0,this.data=null,this.canvas=null,this.context=null,this.width=0,this.height=0,this.offsetY=0,this.hash=void 0,this.char=t,this.labelInfo=e,this.hash=""+t.charCodeAt(0)+e.hash}var e=t.prototype;return e.updateRenderData=function(){this._updateProperties(),this._updateTexture()},e.destroy=function(){this.image=null,At.getInstance().put(this.data)},e._updateProperties=function(){if(this.data=At.getInstance().get(),this.canvas=this.data.canvas,this.context=this.data.context,this.context){var t=this.labelInfo.fontScale;this.context.font=this.labelInfo.fontDesc;var e=Ft(this.context,this.char,this.labelInfo.fontDesc),i=2*this.labelInfo.margin+2;this.width=parseFloat(e.toFixed(2))*t+i,this.height=(1+lt)*this.labelInfo.fontSize*t+i,this.offsetY=-this.labelInfo.fontSize*lt*t/2}this.canvas.width!==this.width&&(this.canvas.width=this.width),this.canvas.height!==this.height&&(this.canvas.height=this.height),this.image||(this.image=new L),this.image.reset(this.canvas)},e._updateTexture=function(){if(this.context&&this.canvas){var t=this.context,e=this.labelInfo,i=this.canvas.width,n=this.canvas.height,r=e.fontScale;t.textAlign="center",t.textBaseline="alphabetic",t.clearRect(0,0,i,n),t.fillStyle=Tt,t.fillRect(0,0,i,n),t.font=e.fontDesc.replace(/(\d+)(\.\d+)?(px|em|rem|pt)/g,(function(t,e,i,n){return(+e*r+(+i||0)*r).toString()+n}));var s=e.fontSize*r,a=i/2,o=n/2+s*ft+0*s,h=e.color;if(t.lineJoin="round",t.fillStyle="rgba("+h.r+", "+h.g+", "+h.b+", 1)",e.isOutlined){var u=e.out||xt;t.strokeStyle="rgba("+u.r+", "+u.g+", "+u.b+", "+u.a/255+")",t.lineWidth=2*e.margin*r,t.strokeText(this.char,a,o)}t.fillText(this.char,a,o)}},t}(),Rt=function(t){function e(){return t.apply(this,arguments)||this}i(e,t);var n=e.prototype;return n.initWithSize=function(t,e,i){void 0===i&&(i=C.RGBA8888),this.reset({width:t,height:e,format:i})},n.drawTextureAt=function(t,e,i){var n=this.getGFXTexture();if(t&&n){var r=this._getGFXDevice();if(r){var s=new B;s.texOffset.x=e,s.texOffset.y=i,s.texExtent.width=t.width,s.texExtent.height=t.height,r.copyTexImagesToTexture([t.data],n,[s])}else console.warn("Unable to get device")}},e}(k);t("o",function(){function t(t,e){this._x=0,this._y=0,this._nextY=0,this._width=0,this._height=0,this._halfBleed=0,this._dirty=!1;var i=new Rt;i.initWithSize(t,e),this.fontDefDictionary=new ot(i),this._halfBleed=1,this._width=t,this._height=e,O.on(U.EVENT_BEFORE_SCENE_LAUNCH,this.beforeSceneLoad,this)}var e=t.prototype;return e.insertLetterTexture=function(t){var e=t.image,i=O.root.device;if(!e||!this.fontDefDictionary||!i)return null;var n=e.width,r=e.height;if(this._x+n+0>this._width&&(this._x=0,this._y=this._nextY),this._y+r>this._nextY&&(this._nextY=this._y+r+0),this._nextY>this._height)return g(12100),null;this.fontDefDictionary.texture.drawTextureAt(e,this._x,this._y),this._dirty=!0;var s=new St;return s.u=this._x+this._halfBleed,s.v=this._y+this._halfBleed,s.texture=this.fontDefDictionary.texture,s.valid=!0,s.w=t.width-2,s.h=t.height-2,s.xAdvance=s.w,s.offsetY=t.offsetY,this._x+=n+0,this.fontDefDictionary.addLetterDefinitions(t.hash,s),s},e.update=function(){this._dirty&&(this._dirty=!1)},e.reset=function(){this._x=0,this._y=0,this._nextY=0,this.fontDefDictionary.clear()},e.destroy=function(){this.reset(),this.fontDefDictionary&&(this.fontDefDictionary.texture.destroy(),this.fontDefDictionary.texture=null)},e.getTexture=function(){return this.fontDefDictionary.getTexture()},e.beforeSceneLoad=function(){this.clearAllCache()},e.clearAllCache=function(){this.destroy();var t=new Rt;t.initWithSize(this._width,this._height),this.fontDefDictionary.texture=t},e.getLetter=function(t){return this.fontDefDictionary.letterDefinitions[t]},e.getLetterDefinitionForChar=function(t,e){var i=t.charCodeAt(0)+e.hash,n=this.fontDefDictionary.letterDefinitions[i];if(!n){var r=new bt(t,e);r.updateRenderData(),n=this.insertLetterTexture(r),r.destroy()}return n},h(t,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}}]),t}()),t("n",{fontAtlas:null,fontSize:0,lineHeight:0,hAlign:0,vAlign:0,hash:"",fontFamily:"",fontDesc:"Arial",color:y.WHITE.clone(),isOutlined:!1,out:y.WHITE.clone(),margin:0,fontScale:1});var wt,Et,Ct,Ot,kt,Ut,Lt,Mt,It,zt,Pt,Ht,Bt,Nt,Vt,Wt,Xt,Yt,jt,Gt,Zt,Kt,$t,Jt,qt,Qt,te,ee,ie,ne,re,se,ae,oe,he,ue,le,fe,ce=function(){function t(){this.isBold=!1,this.isItalic=!1,this.isUnderline=!1,this.underlineHeight=1,this.isOutlined=!1,this.outlineColor=y.WHITE.clone(),this.outlineWidth=1,this.hasShadow=!1,this.shadowColor=y.BLACK.clone(),this.shadowBlur=2,this.shadowOffsetX=0,this.shadowOffsetY=0,this.color=y.WHITE.clone(),this.fontSize=40,this.actualFontSize=0,this.isSystemFontUsed=!1,this.originFontSize=0,this.bmfontScale=1,this.fontFamily="Arial",this.fontDesc="",this.fntConfig=null,this.spriteFrame=null,this.fontScale=1}return t.prototype.reset=function(){this.isBold=!1,this.isItalic=!1,this.isUnderline=!1,this.underlineHeight=1,this.isOutlined=!1,this.outlineColor.set(),this.outlineWidth=1,this.hasShadow=!1,this.shadowColor.set(),this.shadowBlur=2,this.shadowOffsetX=0,this.shadowOffsetY=0},t}(),pe=function(){function t(){this.horizontalAlign=0,this.verticalAlign=0,this.wrapping=!0,this.overFlow=0,this.lineHeight=10,this.maxLineWidth=0,this.spacingX=0,this.textWidthTemp=0,this.textHeightTemp=0,this.textDimensions=new F,this.horizontalKerning=[],this.numberOfLines=1,this.linesOffsetX=[],this.letterOffsetY=0,this.tailoredTopY=0,this.tailoredBottomY=0,this.textDesiredHeight=0,this.linesWidth=[]}return t.prototype.reset=function(){this.horizontalAlign=0,this.verticalAlign=0,this.wrapping=!0,this.overFlow=0,this.lineHeight=10,this.maxLineWidth=0,this.spacingX=0,this.textWidthTemp=0,this.textHeightTemp=0,this.textDimensions.set(),this.horizontalKerning.length=0,this.numberOfLines=1,this.linesOffsetX.length=0,this.letterOffsetY=0,this.tailoredTopY=0,this.tailoredBottomY=0,this.textDesiredHeight=0,this.linesWidth.length=0},t}(),_e=function(){function t(){this.parsedString=[],this.nodeContentSize=F.ZERO.clone(),this.canvasSize=new F,this.canvasPadding=new v,this.contentSizeExtend=F.ZERO.clone(),this.startPosition=A.ZERO.clone()}return t.prototype.reset=function(){this.parsedString.length=0,this.nodeContentSize.set(0,0),this.canvasSize.set(),this.canvasPadding.set(),this.contentSizeExtend.set(),this.startPosition.set()},t}(),de=function(){function t(){this.quadCount=0,this.vertexBuffer=[],this.texture=null,this.uiTransAnchorX=.5,this.uiTransAnchorY=.5}return t.prototype.reset=function(){this.quadCount=0,this.vertexBuffer.length=0,this.texture=null,this.uiTransAnchorX=.5,this.uiTransAnchorY=.5},t}();y.WHITE.clone(),t("H",he),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(he||t("H",he={})),x(he),t("V",ue),function(t){t[t.TOP=0]="TOP",t[t.CENTER=1]="CENTER",t[t.BOTTOM=2]="BOTTOM"}(ue||t("V",ue={})),x(ue),t("O",le),function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.SHRINK=2]="SHRINK",t[t.RESIZE_HEIGHT=3]="RESIZE_HEIGHT"}(le||t("O",le={})),x(le),t("C",fe),function(t){t[t.NONE=0]="NONE",t[t.BITMAP=1]="BITMAP",t[t.CHAR=2]="CHAR"}(fe||t("C",fe={})),x(fe);var ye,ge,me,De,Fe,ve,Ae,xe,Se,Te,be,Re,we,Ee,Ce,Oe,ke,Ue,Le,Me,Ie,ze,Pe,He,Be=t("b",(wt=e("cc.Label"),Et=S(110),Ct=c(he),Ot=c(ue),kt=c(le),Ut=c(K),Lt=c(fe),wt(Mt=Et(((oe=function(t){function e(){var e;return(e=t.call(this)||this)._string=zt&&zt(),e._horizontalAlign=Pt&&Pt(),e._verticalAlign=Ht&&Ht(),e._actualFontSize=Bt&&Bt(),e._fontSize=Nt&&Nt(),e._fontFamily=Vt&&Vt(),e._lineHeight=Wt&&Wt(),e._overflow=Xt&&Xt(),e._enableWrapText=Yt&&Yt(),e._font=jt&&jt(),e._isSystemFontUsed=Gt&&Gt(),e._spacingX=Zt&&Zt(),e._isItalic=Kt&&Kt(),e._isBold=$t&&$t(),e._isUnderline=Jt&&Jt(),e._underlineHeight=qt&&qt(),e._cacheMode=Qt&&Qt(),e._enableOutline=te&&te(),e._outlineColor=ee&&ee(),e._outlineWidth=ie&&ie(),e._enableShadow=ne&&ne(),e._shadowColor=re&&re(),e._shadowOffset=se&&se(),e._shadowBlur=ae&&ae(),e._N$file=null,e._texture=null,e._ttfSpriteFrame=null,e._userDefinedFont=null,e._assemblerData=null,e._fontAtlas=null,e._letterTexture=null,e._contentWidth=0,e._textStyle=null,e._textLayout=null,e._textRenderData=null,e._textLayoutData=null,e._ttfSpriteFrame=null,e._textStyle=new ce,e._textLayout=new pe,e._textLayoutData=new _e,e._textRenderData=new de,e}i(e,t);var n=e.prototype;return n.onEnable=function(){t.prototype.onEnable.call(this),this._font||this._isSystemFontUsed||(this.useSystemFont=!0),this._isSystemFontUsed&&!this._fontFamily&&(this.fontFamily="Arial"),this._applyFontTexture()},n.onDestroy=function(){if(this._assembler&&this._assembler.resetAssemblerData&&this._assembler.resetAssemblerData(this._assemblerData),this._assemblerData=null,this._ttfSpriteFrame){this._ttfSpriteFrame._resetDynamicAtlasFrame();var e=this._ttfSpriteFrame.texture;if(this._ttfSpriteFrame.destroy(),e){var i=e;i.image&&i.image.destroy(),e.destroy()}this._ttfSpriteFrame=null}this._letterTexture=null,t.prototype.onDestroy.call(this)},n.updateRenderData=function(t){void 0===t&&(t=!1),t&&(this._flushAssembler(),this.renderData&&(this.renderData.vertDirty=!0),this._applyFontTexture()),this._assembler&&this._assembler.updateRenderData(this)},n._render=function(t){t.commitComp(this,this.renderData,this._texture,this._assembler,null)},n._updateColor=function(){t.prototype._updateColor.call(this),this.markForUpdateRenderData()},n.setEntityColor=function(){},n._canRender=function(){if(!t.prototype._canRender.call(this)||!this._string)return!1;var e=this._font;if(e&&e instanceof ht){var i=e.spriteFrame;if(!i||!i.texture)return!1}return!0},n._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t,this.textStyle.reset(),this.textLayout.reset(),this.textLayoutData.reset(),this.textRenderData.reset()),this.renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this.renderData.material=this.material,this._updateColor())},n._applyFontTexture=function(){this.markForUpdateRenderData();var t=this._font;if(t instanceof ht){var e=t.spriteFrame;e&&e.texture&&(this._texture=e,this.renderData&&(this.renderData.textureDirty=!0),this.changeMaterialForDefine(),this._assembler&&this._assembler.updateRenderData(this))}else{if(this.cacheMode===fe.CHAR)this._letterTexture=this._assembler.getAssemblerData(),this._texture=this._letterTexture;else if(!this._ttfSpriteFrame){this._ttfSpriteFrame=new R,this._assemblerData=this._assembler.getAssemblerData();var i=new L(this._assemblerData.canvas),n=new k;n.image=i,this._ttfSpriteFrame.texture=n}this.cacheMode!==fe.CHAR&&(this._texture=this._ttfSpriteFrame),this.changeMaterialForDefine()}},n.changeMaterialForDefine=function(){if(this._texture){var t=!1;if(this.cacheMode!==fe.CHAR){var e=this._texture.texture;if(e instanceof M){var i=e.getPixelFormat();t=i===C.RGBA_ETC1||i===C.RGB_A_PVRTC_4BPPV1||i===C.RGB_A_PVRTC_2BPPV1}}this._instanceMaterialType=t?w.USE_ALPHA_SEPARATED:w.ADD_COLOR_AND_TEXTURE,this.updateMaterial()}},n._updateBlendFunc=function(){t.prototype._updateBlendFunc.call(this)},h(e,[{key:"string",get:function(){return this._string},set:function(t){t=null==t?"":t.toString(),this._string!==t&&(this._string=t,this.markForUpdateRenderData())}},{key:"horizontalAlign",get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!==t&&(this._horizontalAlign=t,this.markForUpdateRenderData())}},{key:"verticalAlign",get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!==t&&(this._verticalAlign=t,this.markForUpdateRenderData())}},{key:"actualFontSize",get:function(){return this._actualFontSize},set:function(t){this._actualFontSize=t}},{key:"fontSize",get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.markForUpdateRenderData())}},{key:"lineHeight",get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.markForUpdateRenderData())}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX!==t&&(this._spacingX=t,this.markForUpdateRenderData())}},{key:"overflow",get:function(){return this._overflow},set:function(t){this._overflow!==t&&(this._overflow=t,this.markForUpdateRenderData())}},{key:"enableWrapText",get:function(){return this._enableWrapText},set:function(t){this._enableWrapText!==t&&(this._enableWrapText=t,this.markForUpdateRenderData())}},{key:"useSystemFont",get:function(){return this._isSystemFontUsed},set:function(t){this._isSystemFontUsed!==t&&(this.destroyRenderData(),this._isSystemFontUsed=!!t,t&&(this.font=null),this._flushAssembler(),this.markForUpdateRenderData())}},{key:"fontFamily",get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this.markForUpdateRenderData())}},{key:"font",get:function(){return this._font},set:function(t){this._font!==t&&(this._isSystemFontUsed=!t,this._font=t,this.destroyRenderData(),this._fontAtlas=null,this.updateRenderData(!0))}},{key:"cacheMode",get:function(){return this._cacheMode},set:function(t){this._cacheMode!==t&&(this._cacheMode!==fe.BITMAP||this._font instanceof ht||!this._ttfSpriteFrame||this._ttfSpriteFrame._resetDynamicAtlasFrame(),this._cacheMode===fe.CHAR&&(this._ttfSpriteFrame=null),this._cacheMode=t,this.updateRenderData(!0))}},{key:"isBold",get:function(){return this._isBold},set:function(t){this._isBold!==t&&(this._isBold=t,this.markForUpdateRenderData())}},{key:"isItalic",get:function(){return this._isItalic},set:function(t){this._isItalic!==t&&(this._isItalic=t,this.markForUpdateRenderData())}},{key:"isUnderline",get:function(){return this._isUnderline},set:function(t){this._isUnderline!==t&&(this._isUnderline=t,this.markForUpdateRenderData())}},{key:"underlineHeight",get:function(){return this._underlineHeight},set:function(t){this._underlineHeight!==t&&(this._underlineHeight=t,this.markForUpdateRenderData())}},{key:"enableOutline",get:function(){return this._enableOutline},set:function(t){this._enableOutline!==t&&(this._enableOutline=t,this.markForUpdateRenderData())}},{key:"outlineColor",get:function(){return this._outlineColor},set:function(t){this._outlineColor!==t&&(this._outlineColor.set(t),this.markForUpdateRenderData())}},{key:"outlineWidth",get:function(){return this._outlineWidth},set:function(t){this._outlineWidth!==t&&(this._outlineWidth=t,this.markForUpdateRenderData())}},{key:"enableShadow",get:function(){return this._enableShadow},set:function(t){this._enableShadow!==t&&(this._enableShadow=t,this.markForUpdateRenderData())}},{key:"shadowColor",get:function(){return this._shadowColor},set:function(t){this._shadowColor!==t&&(this._shadowColor.set(t),this.markForUpdateRenderData())}},{key:"shadowOffset",get:function(){return this._shadowOffset},set:function(t){this._shadowOffset!==t&&(this._shadowOffset.set(t),this.markForUpdateRenderData())}},{key:"shadowBlur",get:function(){return this._shadowBlur},set:function(t){this._shadowBlur!==t&&(this._shadowBlur=t,this.markForUpdateRenderData())}},{key:"spriteFrame",get:function(){return this._texture}},{key:"ttfSpriteFrame",get:function(){return this._ttfSpriteFrame}},{key:"assemblerData",get:function(){return this._assemblerData}},{key:"fontAtlas",get:function(){return this._fontAtlas},set:function(t){this._fontAtlas=t}},{key:"_bmFontOriginalSize",get:function(){return this._font instanceof ht?this._font.fontSize:-1}},{key:"textStyle",get:function(){return this._textStyle}},{key:"textLayout",get:function(){return this._textLayout}},{key:"textRenderData",get:function(){return this._textRenderData}},{key:"textLayoutData",get:function(){return this._textLayoutData}},{key:"contentWidth",get:function(){return this._contentWidth},set:function(t){this._contentWidth=t}}]),e}(E)).HorizontalAlign=he,oe.VerticalAlign=ue,oe.Overflow=le,oe.CacheMode=fe,oe._canvasPool=At.getInstance(),u((It=oe).prototype,"horizontalAlign",[Ct],Object.getOwnPropertyDescriptor(It.prototype,"horizontalAlign"),It.prototype),u(It.prototype,"verticalAlign",[Ot],Object.getOwnPropertyDescriptor(It.prototype,"verticalAlign"),It.prototype),u(It.prototype,"overflow",[kt],Object.getOwnPropertyDescriptor(It.prototype,"overflow"),It.prototype),u(It.prototype,"font",[Ut],Object.getOwnPropertyDescriptor(It.prototype,"font"),It.prototype),u(It.prototype,"cacheMode",[Lt],Object.getOwnPropertyDescriptor(It.prototype,"cacheMode"),It.prototype),zt=s(It.prototype,"_string",[o],(function(){return"label"})),Pt=s(It.prototype,"_horizontalAlign",[o],(function(){return he.CENTER})),Ht=s(It.prototype,"_verticalAlign",[o],(function(){return ue.CENTER})),Bt=s(It.prototype,"_actualFontSize",[o],(function(){return 0})),Nt=s(It.prototype,"_fontSize",[o],(function(){return 40})),Vt=s(It.prototype,"_fontFamily",[o],(function(){return"Arial"})),Wt=s(It.prototype,"_lineHeight",[o],(function(){return 40})),Xt=s(It.prototype,"_overflow",[o],(function(){return le.NONE})),Yt=s(It.prototype,"_enableWrapText",[o],(function(){return!0})),jt=s(It.prototype,"_font",[o],(function(){return null})),Gt=s(It.prototype,"_isSystemFontUsed",[o],(function(){return!0})),Zt=s(It.prototype,"_spacingX",[o],(function(){return 0})),Kt=s(It.prototype,"_isItalic",[o],(function(){return!1})),$t=s(It.prototype,"_isBold",[o],(function(){return!1})),Jt=s(It.prototype,"_isUnderline",[o],(function(){return!1})),qt=s(It.prototype,"_underlineHeight",[o],(function(){return 2})),Qt=s(It.prototype,"_cacheMode",[o],(function(){return fe.NONE})),te=s(It.prototype,"_enableOutline",[o],(function(){return!1})),ee=s(It.prototype,"_outlineColor",[o],(function(){return new y(0,0,0,255)})),ie=s(It.prototype,"_outlineWidth",[o],(function(){return 2})),ne=s(It.prototype,"_enableShadow",[o],(function(){return!1})),re=s(It.prototype,"_shadowColor",[o],(function(){return new y(0,0,0,255)})),se=s(It.prototype,"_shadowOffset",[o],(function(){return new A(2,2)})),ae=s(It.prototype,"_shadowBlur",[o],(function(){return 2})),Mt=It))||Mt)||Mt));a.Label=Be,function(t){t[t.SIMPLE=0]="SIMPLE",t[t.SLICED=1]="SLICED",t[t.TILED=2]="TILED",t[t.FILLED=3]="FILLED"}(Ie||(Ie={})),x(Ie),function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.RADIAL=2]="RADIAL"}(ze||(ze={})),x(ze),function(t){t[t.CUSTOM=0]="CUSTOM",t[t.TRIMMED=1]="TRIMMED",t[t.RAW=2]="RAW"}(Pe||(Pe={})),x(Pe),function(t){t.SPRITE_FRAME_CHANGED="spriteframe-changed"}(He||(He={}));var Ne=t("a",(ye=e("cc.Sprite"),ge=S(110),me=c(Y),De=c(R),Fe=c(Ie),ve=c(ze),Ae=c(Pe),ye(xe=ge(((Me=function(t){function e(){for(var e,i=arguments.length,n=new Array(i),r=0;r<i;r++)n[r]=arguments[r];return(e=t.call.apply(t,[this].concat(n))||this)._spriteFrame=Te&&Te(),e._type=be&&be(),e._fillType=Re&&Re(),e._sizeMode=we&&we(),e._fillCenter=Ee&&Ee(),e._fillStart=Ce&&Ce(),e._fillRange=Oe&&Oe(),e._isTrimmedMode=ke&&ke(),e._useGrayscale=Ue&&Ue(),e._atlas=Le&&Le(),e}i(e,t);var n=e.prototype;return n.__preload=function(){this.changeMaterialForDefine(),t.prototype.__preload.call(this)},n.onEnable=function(){t.prototype.onEnable.call(this),this._activateMaterial();var e=this._spriteFrame;e&&(this._updateUVs(),this._type===Ie.SLICED&&e.on(R.EVENT_UV_UPDATED,this._updateUVs,this))},n.onDisable=function(){t.prototype.onDisable.call(this),this._spriteFrame&&this._type===Ie.SLICED&&this._spriteFrame.off(R.EVENT_UV_UPDATED,this._updateUVs,this)},n.onDestroy=function(){t.prototype.onDestroy.call(this)},n.changeSpriteFrameFromAtlas=function(t){if(this._atlas){var e=this._atlas.getSpriteFrame(t);this.spriteFrame=e}else console.warn("SpriteAtlas is null.")},n.changeMaterialForDefine=function(){var t,e=this._instanceMaterialType;this._spriteFrame&&(t=this._spriteFrame.texture);var i=!1;if(t instanceof M){var n=t.getPixelFormat();i=n===C.RGBA_ETC1||n===C.RGB_A_PVRTC_4BPPV1||n===C.RGB_A_PVRTC_2BPPV1}i&&this.grayscale?this._instanceMaterialType=w.USE_ALPHA_SEPARATED_AND_GRAY:i?this._instanceMaterialType=w.USE_ALPHA_SEPARATED:this.grayscale?this._instanceMaterialType=w.GRAYSCALE:this._instanceMaterialType=w.ADD_COLOR_AND_TEXTURE,e!==this._instanceMaterialType&&this.updateMaterial()},n._updateBuiltinMaterial=function(){var e=t.prototype._updateBuiltinMaterial.call(this);if(this.spriteFrame&&this.spriteFrame.texture instanceof I){var i=T({SAMPLE_FROM_RT:!0},e.passes[0].defines),n=new z;n.initialize({effectAsset:e.effectAsset,defines:i}),e=n}return e},n._render=function(t){t.commitComp(this,this.renderData,this._spriteFrame,this._assembler,null)},n._canRender=function(){if(!t.prototype._canRender.call(this))return!1;var e=this._spriteFrame;return!(!e||!e.texture)},n._flushAssembler=function(){var t=e.Assembler.getAssembler(this);this._assembler!==t&&(this.destroyRenderData(),this._assembler=t),this._renderData||this._assembler&&this._assembler.createData&&(this._renderData=this._assembler.createData(this),this._renderData.material=this.getRenderMaterial(0),this.markForUpdateRenderData(),this.spriteFrame&&this._assembler.updateUVs(this),this._updateColor()),this._spriteFrame&&(this._type===Ie.SLICED?this._spriteFrame.on(R.EVENT_UV_UPDATED,this._updateUVs,this):this._spriteFrame.off(R.EVENT_UV_UPDATED,this._updateUVs,this))},n._applySpriteSize=function(){if(this._spriteFrame)if(Pe.RAW===this._sizeMode){var t=this._spriteFrame.originalSize;this.node._uiProps.uiTransformComp.setContentSize(t)}else if(Pe.TRIMMED===this._sizeMode){var e=this._spriteFrame.rect;this.node._uiProps.uiTransformComp.setContentSize(e.width,e.height)}},n._resized=function(){},n._activateMaterial=function(){var t=this._spriteFrame,e=this.getRenderMaterial(0);t&&e&&this.markForUpdateRenderData(),this.renderData&&(this.renderData.material=e)},n._updateUVs=function(){this._assembler&&this._assembler.updateUVs(this)},n._applySpriteFrame=function(t){var e=this._spriteFrame;t&&this._type===Ie.SLICED&&t.off(R.EVENT_UV_UPDATED,this._updateUVs,this);var i=!1;e&&(t&&t.texture===e.texture||(i=!0),i&&(this.renderData&&(this.renderData.textureDirty=!0),this.changeMaterialForDefine()),this._applySpriteSize(),this._type===Ie.SLICED&&e.on(R.EVENT_UV_UPDATED,this._updateUVs,this))},h(e,[{key:"spriteAtlas",get:function(){return this._atlas},set:function(t){this._atlas!==t&&(this._atlas=t)}},{key:"spriteFrame",get:function(){return this._spriteFrame},set:function(t){if(this._spriteFrame!==t){var e=this._spriteFrame;this._spriteFrame=t,this.markForUpdateRenderData(),this._applySpriteFrame(e)}}},{key:"type",get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this._flushAssembler())}},{key:"fillType",get:function(){return this._fillType},set:function(t){this._fillType!==t&&(t===ze.RADIAL||this._fillType===ze.RADIAL?this.destroyRenderData():this.renderData&&this.markForUpdateRenderData(!0)),this._fillType=t,this._flushAssembler()}},{key:"fillCenter",get:function(){return this._fillCenter},set:function(t){this._fillCenter.x=t.x,this._fillCenter.y=t.y,this._type===Ie.FILLED&&this.renderData&&this.markForUpdateRenderData()}},{key:"fillStart",get:function(){return this._fillStart},set:function(t){this._fillStart=b(t,0,1),this._type===Ie.FILLED&&this.renderData&&(this.markForUpdateRenderData(),this._updateUVs())}},{key:"fillRange",get:function(){return this._fillRange},set:function(t){this._fillRange=b(t,-1,1),this._type===Ie.FILLED&&this.renderData&&(this.markForUpdateRenderData(),this._updateUVs())}},{key:"trim",get:function(){return this._isTrimmedMode},set:function(t){this._isTrimmedMode!==t&&(this._isTrimmedMode=t,this._type===Ie.SIMPLE&&this.renderData&&this.markForUpdateRenderData(!0))}},{key:"grayscale",get:function(){return this._useGrayscale},set:function(t){this._useGrayscale!==t&&(this._useGrayscale=t,this.changeMaterialForDefine(),this.updateMaterial())}},{key:"sizeMode",get:function(){return this._sizeMode},set:function(t){this._sizeMode!==t&&(this._sizeMode=t,t!==Pe.CUSTOM&&this._applySpriteSize())}}]),e}(E)).FillType=ze,Me.Type=Ie,Me.SizeMode=Pe,Me.EventType=He,u((Se=Me).prototype,"spriteAtlas",[me],Object.getOwnPropertyDescriptor(Se.prototype,"spriteAtlas"),Se.prototype),u(Se.prototype,"spriteFrame",[De],Object.getOwnPropertyDescriptor(Se.prototype,"spriteFrame"),Se.prototype),u(Se.prototype,"type",[Fe],Object.getOwnPropertyDescriptor(Se.prototype,"type"),Se.prototype),u(Se.prototype,"fillType",[ve],Object.getOwnPropertyDescriptor(Se.prototype,"fillType"),Se.prototype),u(Se.prototype,"sizeMode",[Ae],Object.getOwnPropertyDescriptor(Se.prototype,"sizeMode"),Se.prototype),Te=s(Se.prototype,"_spriteFrame",[o],(function(){return null})),be=s(Se.prototype,"_type",[o],(function(){return Ie.SIMPLE})),Re=s(Se.prototype,"_fillType",[o],(function(){return ze.HORIZONTAL})),we=s(Se.prototype,"_sizeMode",[o],(function(){return Pe.TRIMMED})),Ee=s(Se.prototype,"_fillCenter",[o],(function(){return new A(0,0)})),Ce=s(Se.prototype,"_fillStart",[o],(function(){return 0})),Oe=s(Se.prototype,"_fillRange",[o],(function(){return 0})),ke=s(Se.prototype,"_isTrimmedMode",[o],(function(){return!0})),Ue=s(Se.prototype,"_useGrayscale",[o],(function(){return!1})),Le=s(Se.prototype,"_atlas",[o],(function(){return null})),xe=Se))||xe)||xe));a.Sprite=Ne}}}));
